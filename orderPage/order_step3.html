<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>step3</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap');

        * {
            font-family: "Noto Sans KR", serif;
            font-optical-sizing: auto;
            font-weight: 400;
            font-style: normal;
        }

        /* header 스타일 */
        header {
            width: 100%;
            min-width: 1200px;
            height: 165px;
            border-top: 5px solid #009223;
            display: block;
            position: relative;
        }

        .logo {
            height: 40px;
            position: absolute;
            top: 35px;
            left: 50%;
            transform: translateX(-50%)
        }

        .log_menu {
            position: absolute;
            top: 40px;
            right: 15%;
        }

        .log_menu ul {
            padding: 0px;
            margin: 0px;
            height: 30px;
            display: flex;
            list-style: none;
            align-items: center;
        }

        .log_menu a {
            text-decoration: none;
            color: #666;
        }

        .log_menu li {
            margin: 5px;
            font-size: 13px;
            font-weight: bold;
        }

        .log_menu li::marker {
            color: #ddd;
        }

        .signup {
            list-style: inside;
        }

        .main_nav {
            width: 100%;
            height: 60px;
            /* 영역이 짧아서 히든영역이랑 간격이 있음 충분한 높이 주시면 잘 넘어가요*/
            position: absolute;
            top: 65%;
            display: flex;
            text-align: center;
            align-items: center;
            justify-content: center;
        }

        .bg {
            top: 100%;
            transform: translateY(-4px);
            position: absolute;
            width: 100%;
            height: 0;
            background-color: white;
            border-top: 0.5px solid #ddd;
            z-index: 995;
        }

        .main_nav ul {
            margin: 0px;
            padding: 0px;
            list-style: none;
        }

        .main_nav ul:hover {
            cursor: pointer
        }

        .nav_wrap {
            width: 100%;
            height: 230px;
            position: absolute;
            top: 65%;
        }

        .nav_item {
            float: left;
            width: 165px;
            font-size: 18px;
            font-weight: bold;
            position: relative;
        }

        .nav_item:hover {
            color: #009223;
        }

        .hidden_menu {
            overflow: hidden;
            /* 영역 넘어가면 안보이게 하기*/
            width: 100%;
            height: 0;
            /* 평소에는 높이 0으로 둬서 안보이게 하기*/
            position: absolute;
            left: 0px;
            top: -10px;
            transform: translateY(50px);

            z-index: 999;
        }

        .hidden_menu li {
            margin: 15px 0 15px 0;
            font-size: 15px;
            color: #666;
            letter-spacing: -1px;
        }

        .hidden_menu li:nth-child(1) {
            margin-top: 20px;
        }

        .hidden_menu li:hover {
            color: #009223;
            text-decoration: underline;
        }

        .main_nav:hover .hidden_menu,
        .main_nav:hover .bg {
            height: 260px;
            /* 마우스를 갖다 대면 높이 생기게 하기 */
            transition: 0.5s;
            /* 천천히 나오게 하는 효과*/
        }

        .main_nav:hover .bg {
            border-bottom: 0.5px solid #ddd;
        }



        /* 기본 리셋 및 공통 스타일  */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: sans-serif;
            user-select: none;
        }

        /* 전체 래퍼 스타일  */
        .wrap {
            position: relative;
            display: flex;
            flex-direction: column;
            min-width: 1280px;
            background: url("./image/orderBackground.jpg") no-repeat center top #89cd2f;
            text-align: center;
            align-items: center;
        }

        /* 타이틀 영역  */
        .title-area {
            padding: 60px 0;
        }

        .title {
            color: white;
            font-size: 80px;
            font-weight: bold;
        }

        .sub-title {
            color: white;
            margin-top: 30px;
        }

        /* 단계 표시 영역 */
        .step-section {
            width: 100%;
            height: 170px;
            display: flex;
            justify-content: center;
        }

        /* ── 주문 요약 영역 (상단, 샌드위치 기본 선택 포함)  */
        .summary {
            width: 900px;
            text-align: justify;
            font-family: 'Noto Sans KR', sans-serif;
            color: #333;
            background: #fff;
            border-radius: 12px;
            padding: 30px 80px;
            border: 2px solid #00972c;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .summary h3 {
            font-size: 28px;
            font-weight: bold;
            color: #00972c;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
            letter-spacing: 1px;
        }

        .summary p {
            font-weight: bold;
            font-size: 20px;
            margin-bottom: 12px;
            line-height: 1.5;
            letter-spacing: 0.5px;
        }

        /* 주문 요약 내 각 항목의 값 */
        .summary span {
            font-size: 20px;
            font-weight: 500;
            color: #555;
            margin-left: 8px;
            padding: 4px 8px;
            border-radius: 4px;
        }

        /* ── 슬라이더 영역  */
        .menu-selector {
            width: 900px;
            overflow: hidden;
            margin: 0 auto 60px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }

        .slider {
            display: flex;
            width: 100%;
            transition: transform 0.3s ease;
        }

        .slide {
            flex: 0 0 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            height: 700px;
            font-size: 30px;
            font-weight: bold;
            color: #333;
            padding: 40px;
            overflow: auto;
        }

        /* ── 슬라이드 배경색 (순서대로)  */
        .slide1 {
            background-color: #ffc43b;
        }

        /* 빵 선택 */
        .slide2 {
            background-color: #8bc34a;
        }

        /* 치즈 선택 */
        .slide3 {
            background-color: #2196f3;
        }

        /* 야채 선택 */
        .slide4 {
            background-color: #ff5722;
        }

        /* 소스 선택 */
        .slide5 {
            background-color: #795548;
        }

        /* 추가 선택 */
        .slide6 {
            background-color: #9e9e9e;
        }

        /* 최종 주문 내역 */

        /* 좌우 이동 버튼  */
        .arrow-btn {
            position: absolute;
            top: 70%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.4);
            color: #fff;
            border: none;
            font-size: 40px;
            width: 60px;
            height: 60px;
            cursor: pointer;
            border-radius: 50%;
            z-index: 10;
        }

        .arrow-btn:hover {
            background: rgba(0, 0, 0, 0.6);
        }

        .prev-btn {
            left: calc(50% - 450px);
            margin-left: 10px;
        }

        .next-btn {
            right: calc(50% - 450px);
            margin-right: 10px;
        }

        /* 선택 항목 그리드 및 항목 박스  */
        .selection-wrap {
            width: 100%;
            margin: 0 auto;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px 40px;
            margin-bottom: 20px;
        }

        .header-area {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .header-area .title {
            font-size: 24px;
            font-weight: bold;
            color: #00972c;
        }

        .grid-box {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .item-box {
            border: 1px solid #ddd;
            border-radius: 3px;
            text-align: center;
            cursor: pointer;
            transition: 0.5s;
            background-color: #fff;
            padding: 10px;
        }

        .item-box:hover {
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.1);
        }

        .item-box img {
            width: 200px;
            height: auto;
            margin-bottom: 10px;
        }

        .item-box p {
            font-size: 16px;
            color: #333;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .info-text {
            color: #ff9500;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .item-box.selected {
            background-color: #28a745;
            border-color: #28a745;
            color: #fff;
            border-radius: 8px 28px 8px 8px;
            box-shadow: 3px -3px 10px rgba(0, 0, 0, 0.4);
        }

        .item-box.selected p {
            color: #fff;
        }

        /* 빵 토스팅 옵션  */
        .bread-toasting {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }

        .bread-toasting label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 22px;
        }

        .bread-toasting input {
            margin: 0 10px;
            transform: scale(1.6);
        }

        /* 최종 주문 내역 영역  */
        .final-summary {
            border: 1px solid #bbb;
            border-radius: 10px;
            padding: 30px;
            background: #f7f7f7;
            width: 80%;
            margin: 0 auto;
            text-align: left;
            font-size: 18px;
            position: relative;
        }

        .final-summary h2 {
            margin-bottom: 20px;
            font-size: 28px;
            color: #444;
            text-align: center;
        }

        .final-summary .summary-line {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .final-summary .price {
            font-weight: bold;
            color: #e53;
            margin-left: 5px;
        }

        /* 주문하기 버튼 스타일 */
        #order-button {
            display: block;
            margin: 30px auto 0;
            padding: 15px 30px;
            background-color: #00972c;
            color: white;
            border: none;
            font-size: 18px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #order-button:hover {
            background-color: #007a24;
        }

        /*푸터*/
        footer{
            background-color: rgb(41, 41, 41);
            color: rgb(102, 102, 102);
            position: relative;
        }
        /*상단*/
        .footer_menu{
            padding: 5px;
            border-bottom: 1px solid #3b3b3b;
        }
        footer ul{
            list-style: none;
            display: flex;
            font-size: 14px;
        }
        footer li{
            margin-right: 29px;
        }
        footer a{
            text-decoration: none;
            color: inherit;
        }
        footer strong{
            font-weight: bold;
            color: #bbbbbb;
        }
        /*하단*/
        .footer_info{
            font-size: 13px;
            display: flex;
            padding: 10px 0px 0px 45px;
        }
        footer p{
            padding-right: 5px;
        }
        footer span{
            font-weight: bold;
        }
        .copyright{
            font-size: 13px;
            margin-top: -10px;
            padding: 5px 0px 25px 45px;
        }
        /*sns*/
        .instagram{
            width: 50px;
            height: 50px;
            background-image: url("../footer/imgs/instagram.png");
            position: absolute;
            right: 100px;
            bottom: 20px;
        }
        .instagram:hover{
            background-image: url("../footer/imgs/instagram_hover.png");
        }
        .facebook{
            width: 50px;
            height: 50px;
            background-image: url("../footer/imgs/facebook.png");
            position: absolute;
            right: 35px;
            bottom: 20px;
        }
        .facebook:hover{
            background-image: url("../footer/imgs/facebook_hover.png");
        }
    </style>
</head>

<body>
    <header>
        <div class="logo">
            <a href=../mainpage/html/index.html><img src="../header/image/logo_w.png"></a>
        </div>
        <div class="log_menu">
            <ul>
                <li><a href="">로그인</a></li>
                <li class="signup"><a href="">회원가입</a></li>
                <li><a href="https://www.subway.com/en-us/"><img src="../header/image/icon_utill_global.png"></a></li>
            </ul>
        </div>
        <nav class="main_nav">
            <div class="bg"></div>
            <ul>
                <li class="nav_item">메뉴소개
                    <!--하위메뉴-->
                    <ul class="hidden_menu">
                        <li><a href=""></a>샌드위치</li>
                        <li><a href=""></a>랩ㆍ기타</li>
                        <li><a href=""></a>샐러드</li>
                        <li><a href=""></a>아침메뉴</li>
                        <li><a href=""></a>스마일 썹</li>
                        <li><a href=""></a>단체메뉴</li>
                    </ul>
                </li>
                <li class="nav_item">이용방법
                    <!--하위메뉴-->
                    <ul class="hidden_menu">
                        <li><a href=""></a>써브웨이 이용방법</li>
                        <li><a href=""></a>단체메뉴 이용방법</li>
                        <li><a href=""></a>신선한 재료 소개</li>
                        <li><a href=""></a>App 이용방법</li>
                    </ul>
                </li>
                <li class="nav_item">새소식
                    <!--하위메뉴-->
                    <ul class="hidden_menu">
                        <li><a href=""></a>이벤트ㆍ프로모션</li>
                        <li><a href=""></a>뉴스ㆍ공지사항</li>
                        <li><a href=""></a>광고영상</li>
                    </ul>
                </li>
                <li class="nav_item">써브웨이
                    <!--하위메뉴-->
                    <ul class="hidden_menu">
                        <li><a href=""></a>써브웨이 역사</li>
                        <li><a href=""></a>써브웨이 약속</li>
                        <li><a href=""></a>샌드위치 아티스트 지원</li>
                        <li><a href=""></a>매장찾기</li>
                    </ul>
                </li>
                <li class="nav_item">가맹점
                    <!--하위메뉴-->
                    <ul class="hidden_menu">
                        <li><a href=""></a>써브웨이 프랜차이즈</li>
                        <li><a href=""></a>가맹관련 FAQ</li>
                        <li><a href=""></a>가맹신청ㆍ문의</li>
                        <li><a href=""></a>지사안내</li>
                        <li><a href=""></a>사업설명회</li>
                    </ul>
                </li>
                <li class="nav_item">온라인 주문
                    <!--하위메뉴-->
                    <ul class="hidden_menu">
                        <li><a href=""></a>FAST-SUB</li>
                        <li><a href=""></a>HOME-SUB</li>
                        <li><a href=""></a>단체주문</li>
                    </ul>
                </li>
            </ul>
        </nav>
    </header>
    <div class="wrap">
        <!-- 타이틀 영역 -->
        <div class="title-area">
            <p class="title">Fast-Sub</p>
            <p class="sub-title">온라인 주문 후 매장에서 픽업/시식하는 서비스 입니다.</p>
        </div>
        <!-- 단계 표시 영역  -->
        <div class="step-section"></div>
        <!-- 주문 요약 영역 (상단, 기본 샌드위치 정보 및 토스팅 옵션 포함) -->
        <div class="summary">
            <h3>주문 요약</h3>
            <p>샌드위치: <span class="summary-sandwich"></span></p>
            <p>빵 길이: <span class="summary-breadLength"></span></p>
            <p>빵: <span class="summary-bread"></span></p>
            <p>토스팅 여부: <span class="summary-toasting"></span></p>
            <p>치즈: <span class="summary-cheese"></span></p>
            <p>야채: <span class="summary-veggies"></span></p>
            <p>소스: <span class="summary-sauce"></span></p>
            <p>추가 선택: <span class="summary-addons"></span></p>
        </div>
        <!-- 좌우 이동 버튼 -->
        <button class="arrow-btn prev-btn">&laquo;</button>
        <button class="arrow-btn next-btn">&raquo;</button>

        <!-- 슬라이더 영역 -->
        <div class="menu-selector">
            <div class="slider">
                <!-- 슬라이드 1: 빵 선택 (단일) -->
                <div class="slide slide1">
                    <div class="selection-wrap">
                        <div class="header-area">
                            <span class="title">빵 선택 (단일)</span>
                        </div>
                        <div class="grid-box bread-grid"></div>
                        <!-- 토스팅 옵션 -->
                        <div class="bread-toasting">
                            <label><input type="radio" name="toasting" value="토스팅">토스팅</label>
                            <label><input type="radio" name="toasting" value="토스팅 안 함" checked>토스팅 안 함</label>
                        </div>
                    </div>
                </div>

                <!-- 슬라이드 2: 치즈 선택 및 치즈 추가 (단일) -->
                <div class="slide slide2">
                    <div class="selection-wrap">
                        <div class="header-area">
                            <span class="title">치즈 선택 (단일)</span>
                        </div>
                        <div class="grid-box cheese-grid"></div>
                        <hr>
                        <div class="header-area" style="margin-top:20px;">
                            <span class="title">치즈 추가 (단일)</span>
                        </div>
                        <div class="grid-box cheese-grid-extra"></div>
                    </div>
                </div>

                <!-- 슬라이드 3: 야채 선택 (다중) -->
                <div class="slide slide3">
                    <div class="selection-wrap">
                        <div class="header-area">
                            <span class="title">야채 선택 (다중)</span>
                        </div>
                        <div class="grid-box veggie-grid"></div>
                    </div>
                </div>

                <!-- 슬라이드 4: 소스 선택 (다중, 최대 3개) -->
                <div class="slide slide4">
                    <div class="selection-wrap">
                        <div class="header-area">
                            <span class="title">소스 선택 (다중, 최대 3개)</span>
                        </div>
                        <div class="grid-box sauce-grid"></div>
                    </div>
                </div>

                <!-- 슬라이드 5: 추가 선택 (다중) -->
                <div class="slide slide5">
                    <div class="selection-wrap">
                        <div class="header-area">
                            <span class="title">추가 선택 (다중)</span>
                        </div>
                        <div class="grid-box add-grid"></div>
                    </div>
                </div>

                <!-- 슬라이드 6: 최종 주문 내역 (주문하기 버튼 포함) -->
                <div class="slide slide6">
                    <div class="selection-wrap final-summary">
                        <h2>최종 주문 내역</h2>
                        <div class="summary-line"><strong>샌드위치:</strong> <span id="final-sandwich"></span></div>
                        <div class="summary-line"><strong>빵길이:</strong> <span id="final-breadLength"></span></div>
                        <div class="summary-line"><strong>빵:</strong> <span id="final-bread"></span></div>
                        <div class="summary-line"><strong>토스팅 여부:</strong> <span id="final-toasting"></span></div>
                        <div class="summary-line"><strong>치즈:</strong> <span id="final-cheese"></span></div>
                        <div class="summary-line"><strong>야채:</strong> <span id="final-veggies"></span></div>
                        <div class="summary-line"><strong>소스:</strong> <span id="final-sauce"></span></div>
                        <div class="summary-line"><strong>추가 선택:</strong> <span id="final-addons"></span></div>
                        <hr>
                        <div class="summary-line"><strong>총 가격:</strong> <span id="final-price" class="price"></span> 원
                        </div>
                        <!-- 주문하기 버튼 -->
                        <button id="order-button">주문하기</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 스크립트: 기능 구현 및 이벤트 처리 -->
    <script>
        // 스텝 인디케이터 표시 (상단)
        function showStepIndicator(stepNum) {
            // 스텝 타이틀
            const stepTitles = ["매장선택", "메뉴선택", "주문하기", ""];

            const stepArea = document.querySelector(".step-section");
            stepArea.innerHTML = "";

            for (let i = 0; i < 4; i++) {
                const imgBox1 = document.createElement("div");
                const imgBox2 = document.createElement("div");
                const stepImg = document.createElement("img");
                const pointImg = document.createElement("img");
                const onSuffix = `_on`;
                const margin = 10;

                stepImg.style.marginLeft = `${margin}px`;
                stepImg.style.marginRight = `${margin}px`;
                pointImg.style.marginLeft = `${margin}px`;
                pointImg.style.marginRight = `${margin}px`;
                pointImg.style.marginTop = "30px";

                if (stepNum === i + 1) {
                    stepImg.src = `./image/step${i + 1}${onSuffix}.png`;
                    stepImg.style.marginRight = "-45px";
                    stepImg.style.marginTop = "-15px";
                    stepImg.classList.add("onStep");
                    pointImg.src = `./image/step_point_on.png`;
                } else {
                    stepImg.src = `./image/step${i + 1}.png`;
                    if (i === 3) {
                        pointImg.style.display = "none";
                    } else {
                        pointImg.src = `./image/step_point_off.png`;
                    }
                }
                imgBox1.appendChild(stepImg);
                imgBox2.appendChild(pointImg);
                stepArea.appendChild(imgBox1);
                stepArea.appendChild(imgBox2);
            }

            const onStepParent = document.querySelector(".onStep")?.parentElement;
            if (!onStepParent) return;

            const stepText1 = document.createElement("p");
            stepText1.textContent = `STEP${stepNum}`;
            const stepText2 = document.createElement("p");
            stepText2.textContent = stepTitles[stepNum - 1];

            onStepParent.appendChild(stepText1);
            onStepParent.appendChild(stepText2);

            onStepParent.style.position = "relative";
            stepText1.style.position = "absolute";
            stepText1.style.top = "5px";
            stepText1.style.left = "110px";
            stepText1.style.fontSize = "16px";
            stepText1.style.fontWeight = "bold";
            stepText1.style.color = "#ffc300";

            stepText2.style.position = "absolute";
            stepText2.style.top = "25px";
            stepText2.style.left = "110px";
            stepText2.style.fontSize = "24px";
            stepText2.style.fontWeight = "bold";
            stepText2.style.color = "white";
        }

        /* 데이터 정의 (각 카테고리별 항목 정보) */
        const data = {
            sandwich: [
                { name: "에그마요", price: 5400 }
            ],
            bread: [
                { name: "화이트" },
                { name: "파마산 오레가노" },
                { name: "위트" },
                { name: "허니오트" },
                { name: "하티" },
                { name: "플랫브레드" }
            ],
            cheese: [
                { name: "아메리칸치즈" },
                { name: "슈레드치즈" },
                { name: "모차렐라치즈" },
                { name: "콰트로 치즈" }
            ],
            cheeseExtra: [
                { name: "아메리칸치즈", price: 1400 },
                { name: "슈레드치즈", price: 1400 },
                { name: "모차렐라치즈", price: 1400 },
                { name: "콰트로 치즈", price: 1400 }
            ],
            veggies: [
                { name: "양상추" },
                { name: "토마토" },
                { name: "오이" },
                { name: "피망(파프리카)" },
                { name: "양파" },
                { name: "피클" },
                { name: "올리브" },
                { name: "할라피뇨" },
                { name: "모든 야채 제외", isExclude: true }
            ],
            sauces: [
                { info: "크리미한", name: "랜치" },
                { info: "달콤한", name: "스위트 어니언" },
                { info: "고소한", name: "마요네즈" },
                { info: "매콤달콤한", name: "스위트 칠리" },
                { info: "스모크 향", name: "스모크 바비큐" },
                { info: "화끈하게 매운", name: "핫 칠리" },
                { info: "새콤달콤한", name: "허니 머스타드" },
                { info: "이국적으로 매콤한", name: "사우스웨스트 치폴레" },
                { info: "알싸한", name: "홀스래디쉬" },
                { info: "알싸한", name: "머스타드" },
                { info: "이태리 엑스트라버진", name: "올리브 오일" },
                { info: "과일향", name: "레드 와인 식초" },
                { name: "소금" },
                { name: "후추" },
                { name: "소스 제외", isExclude: true }
            ],
            addons: [
                { name: "페퍼로니", price: 1400 },
                { name: "베이컨", price: 1500 },
                { name: "아보카도", price: 1500 },
                { name: "오믈렛", price: 1800 },
                { name: "에그 슬라이스", price: 1200 }
            ]
        };

        /* 선택된 항목 저장 객체 (실제로 이 데이터를 localStorage로 저장할 예정) */
        const selected = {
            // 샌드위치는 일단 "에그마요" (1개)로 고정 가정
            sandwich: "에그마요",
            breadLength: "",
            bread: "",
            cheese: "",
            cheeseExtra: "",
            veggies: [],
            sauces: [],
            addons: [],
            toasting: "토스팅 안 함",
            totalPrice: 0
        };

        /* 주문 요약 업데이트 함수 */
        function updateSummary() {
            document.querySelector(".summary-sandwich").textContent = selected.sandwich || "";
            document.querySelector(".summary-breadLength").textContent = selected.breadLength || "";
            document.querySelector(".summary-bread").textContent = selected.bread || "";
            document.querySelector(".summary-toasting").textContent = selected.toasting || "";

            const cheeseStr = selected.cheese + (selected.cheeseExtra ? ` (+${selected.cheeseExtra})` : "");
            document.querySelector(".summary-cheese").textContent = cheeseStr.trim();

            document.querySelector(".summary-veggies").textContent = selected.veggies.join(", ");
            document.querySelector(".summary-sauce").textContent = selected.sauces.join(", ");
            document.querySelector(".summary-addons").textContent = selected.addons.join(", ");
        }

        /* 최종 주문 내역 렌더링 함수 (슬라이드 6 진입 시 실행) */
        function renderFinalSummary() {
            // 화면 표시
            document.getElementById("final-sandwich").textContent = selected.sandwich;
            document.getElementById("final-breadLength").textContent = selected.breadLength;
            document.getElementById("final-bread").textContent = selected.bread;
            document.getElementById("final-toasting").textContent = selected.toasting;

            const cheeseStr = selected.cheese + (selected.cheeseExtra ? ` (+${selected.cheeseExtra})` : "");
            document.getElementById("final-cheese").textContent = cheeseStr.trim();

            document.getElementById("final-veggies").textContent = selected.veggies.join(", ");
            document.getElementById("final-sauce").textContent = selected.sauces.join(", ");
            document.getElementById("final-addons").textContent = selected.addons.join(", ");

            // 총 가격 계산
            let total = 0;
            // 샌드위치 가격 (기본 5400원)
            total += getItemPrice(selected.sandwich, data.sandwich);

            // 치즈 추가 가격
            if (selected.cheeseExtra) {
                total += getItemPrice(selected.cheeseExtra, data.cheeseExtra);
            }

            // 추가 선택 가격
            selected.addons.forEach(addItem => {
                total += getItemPrice(addItem, data.addons);
            });

            selected.totalPrice = total; // selected에 저장
            document.getElementById("final-price").textContent = total;
        }

        /* 데이터 배열에서 항목 가격 반환 함수 */
        function getItemPrice(itemName, dataArray) {
            const found = dataArray.find(i => i.name === itemName);
            return (found && found.price) ? found.price : 0;
        }

        /* 슬라이더 관련 변수 및 함수 */
        let currentIndex = 0;
        function moveSlide(newIndex) {
            const slides = document.querySelectorAll(".slide");
            const slideCount = slides.length;
            if (newIndex < 0) newIndex = 0;
            if (newIndex >= slideCount) newIndex = slideCount - 1;
            currentIndex = newIndex;
            const slider = document.querySelector(".slider");
            const offset = -(currentIndex * slider.offsetWidth);
            slider.style.transform = `translateX(${offset}px)`;

            // 최종 주문 내역 슬라이드(6번)일 경우 렌더링
            if (currentIndex === 5) {
                renderFinalSummary();
            }
        }
        function goPrev() { moveSlide(currentIndex - 1); }
        function goNext() { moveSlide(currentIndex + 1); }

        /* 공통: 항목 박스 생성 함수 */
        function createItemBox(item, folderName, options) {
            const box = document.createElement("div");
            box.classList.add("item-box");

            // 이미지
            const img = document.createElement("img");
            img.src = `./image/${folderName}/${item.name}.png`;
            img.alt = item.name;
            box.appendChild(img);

            // 추가 정보(예: 소스 info) 표시
            if (options.showInfo && item.info) {
                const infoP = document.createElement("p");
                infoP.classList.add("info-text");
                infoP.textContent = item.info;
                box.appendChild(infoP);
            }

            // 이름
            const nameP = document.createElement("p");
            nameP.textContent = item.name;
            box.appendChild(nameP);

            // 가격 표시
            if (options.showPrice && item.price) {
                const priceP = document.createElement("p");
                priceP.textContent = `+ ${item.price}원`;
                box.appendChild(priceP);
            }

            return box;
        }

        /* 기본 클릭 처리 함수 (단일/다중 선택 처리) */
        function defaultOnClick(box, item, container, config) {
            const key = config.selectedKey; // 예: "bread", "veggies", "addons" 등

            if (config.selectionType === "single") {
                // 단일 선택
                const already = box.classList.contains("selected");
                // 같은 그리드의 다른 항목들 선택 해제
                container.querySelectorAll(".item-box").forEach(el => el.classList.remove("selected"));
                if (!already) {
                    box.classList.add("selected");
                    selected[key] = item.name;
                } else {
                    selected[key] = "";
                }
            }
            else if (config.selectionType === "multiple") {
                // 다중 선택
                if (item.isExclude) {
                    // '제외' 항목 클릭 시 다른 모든 선택 해제
                    const already = box.classList.contains("selected");
                    container.querySelectorAll(".item-box").forEach(el => el.classList.remove("selected"));
                    selected[key] = [];
                    if (!already) {
                        box.classList.add("selected");
                        selected[key] = [item.name];
                    }
                } else {
                    // '제외'가 선택되어 있다면 해제
                    if (config.excludeText) {
                        const excludeBox = [...container.querySelectorAll(".item-box")]
                            .find(el => el.textContent.trim() === config.excludeText);
                        if (excludeBox && excludeBox.classList.contains("selected")) {
                            excludeBox.classList.remove("selected");
                            selected[key] = selected[key].filter(v => v !== config.excludeText);
                        }
                    }
                    // 현재 항목 토글
                    if (box.classList.contains("selected")) {
                        box.classList.remove("selected");
                        selected[key] = selected[key].filter(v => v !== item.name);
                    } else {
                        // 최대 선택 개수 제한
                        if (config.maxCount && selected[key].length >= config.maxCount) {
                            alert(config.maxCountAlert || `최대 ${config.maxCount}개까지 선택 가능합니다.`);
                            return;
                        }
                        box.classList.add("selected");
                        selected[key].push(item.name);
                    }
                }
            }
        }

        /* 범용 그리드 생성 함수 */
        function createGrid(folderName, container, items, config) {
            items.forEach(item => {
                const box = createItemBox(item, folderName, config);
                box.addEventListener("click", () => {
                    if (config.onClick) {
                        config.onClick(box, item, container);
                    } else {
                        defaultOnClick(box, item, container, config);
                    }
                    updateSummary();
                });
                container.appendChild(box);
            });
        }

        /* 주문하기 버튼 클릭 시: 필수 항목 체크 후 localStorage 저장 & step4로 이동 */
        function handleOrder() {
            // 필수 항목 체크
            if (!selected.sandwich || !selected.bread || !selected.cheese) {
                alert("필수 항목(샌드위치, 빵, 치즈)이 선택되지 않았습니다.");
                return;
            }

            let total = 0;
            total += getItemPrice(selected.sandwich, data.sandwich);
            if (selected.cheeseExtra) {
                total += getItemPrice(selected.cheeseExtra, data.cheeseExtra);
            }
            selected.addons.forEach(addItem => {
                total += getItemPrice(addItem, data.addons);
            });
            selected.totalPrice = total;

            // localStorage 저장할 객체
            const orderInfo = {
                sandwich: selected.sandwich,
                breadLength: selected.breadLength,
                bread: selected.bread,
                toasting: selected.toasting,
                cheese: selected.cheese + (selected.cheeseExtra ? ` (+${selected.cheeseExtra})` : ""),
                veggies: selected.veggies,
                sauce: selected.sauces,
                addons: selected.addons,
                price: selected.totalPrice
            };

            // 저장
            localStorage.setItem("orderInfo", JSON.stringify(orderInfo));

            alert("주문이 완료되었습니다!");
            // step4로 이동
            window.location.href = "./order_step4.html";
        }

        /* DOMContentLoaded 이후 초기화 */
        window.addEventListener("load", function () {
            const breadLength = JSON.parse(localStorage.getItem("orderInfo"));
            selected.breadLength = breadLength.breadLength

            showStepIndicator(2);
            // 좌우 버튼 이벤트 바인딩
            document.querySelector(".prev-btn").addEventListener("click", goPrev);
            document.querySelector(".next-btn").addEventListener("click", goNext);

            // 토스팅 옵션
            document.querySelectorAll('input[name="toasting"]').forEach(input => {
                input.addEventListener("change", function () {
                    selected.toasting = this.value;
                    updateSummary();
                });
            });

            // 빵 선택 (단일)
            createGrid("빵", document.querySelector(".bread-grid"), data.bread, {
                selectionType: "single",
                selectedKey: "bread"
            });

            // 치즈 선택 (단일)
            createGrid("치즈", document.querySelector(".cheese-grid"), data.cheese, {
                selectionType: "single",
                selectedKey: "cheese",
                showPrice: false
            });
            // 치즈 추가 (단일)
            createGrid("치즈", document.querySelector(".cheese-grid-extra"), data.cheeseExtra, {
                selectionType: "single",
                selectedKey: "cheeseExtra",
                showPrice: true
            });

            // 야채 선택 (다중)
            createGrid("야채", document.querySelector(".veggie-grid"), data.veggies, {
                selectionType: "multiple",
                selectedKey: "veggies",
                excludeText: "모든 야채 제외"
            });

            // 소스 선택 (다중, 최대 3개)
            createGrid("소스", document.querySelector(".sauce-grid"), data.sauces, {
                selectionType: "multiple",
                selectedKey: "sauces",
                excludeText: "소스 제외",
                maxCount: 3,
                maxCountAlert: "소스는 최대 3개까지 선택 가능합니다.",
                showInfo: true
            });

            // 추가 선택 (다중)
            createGrid("추가 선택", document.querySelector(".add-grid"), data.addons, {
                selectionType: "multiple",
                selectedKey: "addons",
                showPrice: true
            });

            updateSummary();

            // 주문하기 버튼
            document.getElementById("order-button").addEventListener("click", handleOrder);
        });
    </script>
    <footer>
        <!--상단-->
        <div class="footer_menu">
            <ul>
                <li><a href="/agreement">이용약관</a></li>
                <li><a href="/privacy"><strong>개인정보처리방침</strong></a></li>
                <li><a href="/subcard">써브카드</a></li>
                <li><a href="https://store.subway.co.kr/">점주관리자</a></li>
            </ul>
        </div>
        <!--하단-->
        <div class="footer_info">
            <p>서울시 서초구 강남대로 535 프린스빌딩 15층</p>
            <p><span>I</span></p>
            <p>대표 : INSOO CHO(인수조)</p>
            <p><span>I</span></p>
            <p>전화 : 02-797-5036</p>
            <p><span>I</span></p>
            <p>사업자등록번호 : 101-84-04143</p>
        </div>
        <div class="copyright">SUBWAY® is a Registered Trademark of Subway IP LLC. © 2021 Subway IP LLC. All Rights Reserved.</div>
        <!--sns-->
        <a class="instagram" href="https://www.instagram.com/subwaykorea"></a>
        <a class="facebook" href="https://www.facebook.com/Subwaykr"></a>
    </footer>
</body>

</html>